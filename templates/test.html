{% extends "base.html" %}
{% block body %}
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<div id="analytics"></div>
    <div id="typing_analytics">TYPING ANALYTICS</div>
    <div id="gen_link">
        <img src="/static/img/kb2.jpg" width="50%" id="keyboard_img"></img>
    </div>
    <div id="white"></div>

    <div id="data">
        <div id="metrics1">
            <div class="Ametrics" id="distance"><div id="d">{{distance[:-3]}}<br></div><br><div class="AmetricsContent">Distance<br>(mm)</div></div>
            <div class="Ametrics" id="wpm"><div id="w">{{wpm}}</div><br><div class="AmetricsContent">Words Per Minute</div></div>
            <div class="Ametrics" id="accuracy"><div id="a">{{accuracy[:-2]}}%</div><br><div class="AmetricsContent"><div id="acc">Accuracy</div></div></div>
        </div>

        <div id="metrics_gen">
            <form method="POST" id="gen_form" action="/pekl">
                <input type="hidden" name="fast" value="{{fast|tojson|safe}}">
                <input type="hidden" name="att" value="{{att[4]|tojson|safe}}">
                <input type="hidden" name="keys" value="{{keys|tojson|safe}}">
                <input type="submit" id="view_keyboard" value="Generate Your Keyboard">
            </form>
        </div>

        <div id="metrics2">
            <div id="hands"><div id="d3hands"></div></div>
        </div>
        <div class="label_typing" id="hands_label">Hand usage</div>
        
        <div id="metrics3">
            <div id="fingers"><div id="d3fingers"></div>
            </div>
            <div class="label_typing" id="fingers_label">Finger usage</div>
        </div>

        <div id="metrics4">
            <div class="dataBox label_typing" id="freq_label">Letter Frequencies</div>
            <div class="dataBox" id="freq">{{freq}}</div>
        </div>

        <div id="metrics5">
            <div class="dataBox" id="mistyped">{{mistyped}}</div>
            <div class="dataBox label_typing" id="mistyped_label">Most Mistyped Word</div>
            <div id="mistakesBox">
                <div class="dataBox" id="mistakes">{{mostmistakes}}</div>
                <div class="dataBox label_typing" id="mistakes_label">Mistakes</div>
                <div class="dataBox label_typing" id="mistakes_label">Mistakes</div>
            </div>
        </div>

        <div class="subtitle" id="profile">Typing Profile</div>

        <div id="metrics6">
            <div class="dataBox" id="profile_times">
                <b>Fastest dwell times</b> {{fastdwell}}<br>
                <b>Slowest dwell times</b> {{slowdwell}}<br>
                <b>Fastest flight times</b> {{fastflights}}<br>
                <b>Slowest flight times</b> {{slowflights}}<br><br>
            </div>
        </div>

        <div class="subtitle" id="bigram">Bigram Metrics</div>

        <div id="metrics7">
            <div class="dataBox metrics7"id="s_times">
                {{slowbigrams}}
                <div class="label_typing" id="s_times_label">
                    Slowest times
                </div>
            </div>
            <div class="dataBox metrics7" id="f_times">
                {{fastbigrams}}
                <div class="label_typing" id="f_times_label">
                    Fastest times
                </div>
            </div>
        </div>

        <div id="metrics8">
            <div class="dataBox" id="attr">
                <div class="label_typing" id="fastest_label">
                    Fastest attributes
                </div>
                {{att[3][0][0]}}<br>
                {{att[3][0][1]}}<br>
                {{att[3][0][2]}}
            </div>
        </div>

        <div id="metrics9">
            <div id="fhd">
                <div class="dataBox metrics9" id="fhd_f">Same finger use {{biAtt[1]}}</div>
                <div class="dataBox metrics9" id="fhd_h">Hand alteration {{biAtt[0]}}</div>
                <div class="dataBox metrics9" id="fhd_d">Horizontal/vertial movement {{biAtt[2]}}</div>
            </div>
        </div>
    </data>

<script type="text/javascript">
    var fingersSVG = d3.select("#d3fingers")
        .append("svg")
        .attr("width", 450)
        .attr("height", 210); 

    var fingers = {{fingers|tojson|safe}};
    var x = 0;

    for (var i=0; i < fingers.length; i++) {
        if ((i == 4) || (i == 5)) {
            x += 25;
        } else {
            x += 0;
        }

        fingersSVG.append("rect")
            .attr("x", (35 * i) + x)
            .attr("y", 0)
            .attr("width", 25)
            .attr("height", fingers[i])
            .style("fill", "gray")
    }

    var handsSVG = d3.select("#d3hands")
        .append("svg")
        .attr("width", 450)
        .attr("height", 610); 

    var hands = {{hands|tojson|safe}};

    for (var j=0; j < hands.length; j++) {        
 
        handsSVG.append("rect")
            .attr("x", (35 * j))
            .attr("y", 0)
            .attr("width", 25)
            .attr("height", hands[j])
            .style("fill", "gray")
    }

</script>
{% endblock %}